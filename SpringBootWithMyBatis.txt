package com.codex.springbootwithmybatis.contoller;

import com.codex.springbootwithmybatis.mapper.UserMapper;
import com.codex.springbootwithmybatis.model.UserModel;
import com.codex.springbootwithmybatis.service.UserService;
import org.apache.catalina.User;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/mybatistutorial/user")
public class UserController {

    private final UserMapper userMapper;
    private UserService userService;

    public UserController(UserService userService, UserMapper userMapper) {
        this.userService = userService;
        this.userMapper = userMapper;
    }
                                                    
    @GetMapping()
    public List<UserModel> getUsers() {
        return userService.getUsers();
    }

    @PostMapping
    public void createUser (@RequestBody UserModel userModel){
        System.out.println(userModel);
        userService.createUser(userModel);
    }

    @PutMapping("/{userId}")
    public void updateUser (@PathVariable int userId, @RequestBody UserModel userModel){
        userService.updateUser (userId,userModel);
    }
}



package com.codex.springbootwithmybatis.mapper;

import com.codex.springbootwithmybatis.model.UserModel;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.annotations.Update;
import org.springframework.web.bind.annotation.PutMapping;

import java.util.List;

public interface UserMapper {

    @Select("SELECT * FROM  users;")
    public List<UserModel> getUsers();

    @Insert("INSERT INTO users(userid, username, email) VALUES (#{userid},#{username}, #{email})")
    public void createUser(UserModel userModel);

    @PutMapping("UPDATE users SET username=#{username}, email=#{email} WHERE userid=#{userid}")
    public void updateUser(UserModel userModel);
}


package com.codex.springbootwithmybatis.model;

public class UserModel {
    private int userid;
    private String username;
    private String email;

    public UserModel(int userid, String username, String email) {
        this.userid = userid;
        this.username = username;
        this.email = email;
    }

    public int getUserid() {
        return userid;
    }

    public void setUserid(int userid) {
        this.userid = userid;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    @Override
    public String toString() {
        return "UserModel{" +
                "userid=" + userid +
                ", username='" + username + '\'' +
                ", email='" + email + '\'' +
                '}';
    }
}



package com.codex.springbootwithmybatis.service;

import com.codex.springbootwithmybatis.mapper.UserMapper;
import com.codex.springbootwithmybatis.model.UserModel;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Component;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;

import java.util.List;

@Component
public class UserService {

    UserMapper userMapper;

    public UserService(UserMapper userMapper) {
        this.userMapper = userMapper;
    }
    
    public List<UserModel> getUsers() {
         return userMapper.getUsers();
    }

    public void createUser (UserModel userModel){
       userMapper.createUser(userModel);
    }

    public void updateUser (int userId, UserModel userModel){
        userModel.setUserid(userId);
        userMapper.updateUser (userModel);
    }


}


package com.codex.springbootwithmybatis;

import com.codex.springbootwithmybatis.model.UserModel;
import org.apache.ibatis.type.MappedTypes;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@MappedTypes(UserModel.class)
@MapperScan("com.codex.springbootwithmybatis.mapper")
@SpringBootApplication
public class SpringBootWithMyBatisApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootWithMyBatisApplication.class, args);
    }

}



spring.application.name=SpringBootWithMyBatis

# MySQL things

spring.datasource.url=jdbc:mysql://localhost:3306/mybatis_tutorial
spring.datasource.username=root
spring.datasource.password=root1234
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver



<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.4.3</version>
        <relativePath/> <!-- lookup parent from repository -->
    </parent>
    <groupId>com.codeX</groupId>
    <artifactId>SpringBootWithMyBatis</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>SpringBootWithMyBatis</name>
    <description>SpringBootWithMyBatis</description>
    <url/>
    <licenses>
        <license/>
    </licenses>
    <developers>
        <developer/>
    </developers>
    <scm>
        <connection/>
        <developerConnection/>
        <tag/>
        <url/>
    </scm>
    <properties>
        <java.version>17</java.version>
    </properties>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.mybatis.spring.boot</groupId>
            <artifactId>mybatis-spring-boot-starter</artifactId>
            <version>3.0.4</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-devtools</artifactId>
            <scope>runtime</scope>
            <optional>true</optional>
        </dependency>
        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.mybatis.spring.boot</groupId>
            <artifactId>mybatis-spring-boot-starter-test</artifactId>
            <version>3.0.4</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project>
